(this["webpackJsonp@xenpaper/xenpaper-app"]=this["webpackJsonp@xenpaper/xenpaper-app"]||[]).push([[0],{71:function(e,n,t){"use strict";t.r(n);var r,c,o,i,a,s,l,u=t(10),d=t.n(u),h=t(40),b=t.n(h),j=t(25),f=t(15),p=t(9),m=t(8),v=t.n(m),O=t(13),g=t(12),x=t(14),y=t(6),w=Object(x.b)(r||(r=Object(f.a)(["\n    html, body, div, span, applet, object, iframe,\n    h1, h2, h3, h4, h5, h6, p, blockquote, pre,\n    a, abbr, acronym, address, big, cite, code,\n    del, dfn, em, img, ins, kbd, q, s, samp,\n    small, strike, strong, sub, sup, tt, var,\n    b, u, i, center,\n    dl, dt, dd, ol, ul, li,\n    fieldset, form, label, legend,\n    table, caption, tbody, tfoot, thead, tr, th, td,\n    article, aside, canvas, details, embed,\n    figure, figcaption, footer, header, hgroup,\n    menu, nav, output, ruby, section, summary,\n    time, mark, audio, video {\n        margin: 0;\n        padding: 0;\n        border: 0;\n        font-size: 100%;\n        font: inherit;\n        vertical-align: baseline;\n    }\n    article, aside, details, figcaption, figure,\n    footer, header, hgroup, menu, nav, section {\n        display: block;\n    }\n    body {\n        line-height: 1;\n    }\n    ol, ul {\n        list-style: none;\n    }\n    blockquote, q {\n        quotes: none;\n    }\n    blockquote:before, blockquote:after,\n    q:before, q:after {\n        content: '';\n        content: none;\n    }\n    table {\n        border-collapse: collapse;\n        border-spacing: 0;\n    }\n    * {\n        box-sizing: border-box;\n    }\n\n    html {\n        font-family: 'DM Mono', sans-serif;\n        height: 100%;\n        line-height: 1.5em;\n        position: relative;\n        -webkit-font-smoothing: antialiased;\n        -moz-osx-font-smoothing: grayscale;\n        background-color: #0e151b;\n        color: #ffffff;\n        font-size: 16px;\n    }\n\n    body {\n        font-weight: 400;\n        height: 100%;\n        line-height: 1.5em;\n        overflow-x: hidden;\n        text-rendering: optimizelegibility;\n\n        &[aria-hidden='true'] {\n            overflow: hidden;\n        }\n    }\n\n    #root {\n        height: 100%;\n    }\n"]))),k={colors:{background:{normal:"#0e151b",light:"#18232d"},text:{placeholder:"#198c8c"},focus:"#115d5d",highlights:{delimiter:"#198c8c",pitch:"#22cece",chord:"#22cece",setterGroup:"#821361",setter:"#d61ba4",scaleGroup:"#94472f",scale:"#ff541e",comment:"#ffffff",commentStart:"#198c8c",unknown:"#a490b3",error:"#cc0000",errorMessage:"#cc0000"}},fonts:{mono:"'DM Mono', sans-serif",copy:"'Nunito', sans-serif"},widths:{sm:"640px"}};function S(e){var n=e.children;return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com"}),Object(y.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,400;0,500;1,400&display=swap",rel:"stylesheet"}),Object(y.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Nunito:wght@300;400&display=swap",rel:"stylesheet"}),Object(y.jsxs)(x.a,{theme:k,children:[Object(y.jsx)(w,{}),n]})]})}var E,C,T,M,z,P,R,_,L,N,D,A,G,q,H,F,B,I,V,U,X,Z,W,Y,K,J,Q,$,ee,ne,te=Object(x.e)(c||(c=Object(f.a)(["\n  0% {\n    clip-path: polygon(0% 0%, 0% 0%, 100% 100%, 100% 100%, 100% 100%, 0% 0%);\n  }\n\n  20% {\n    clip-path: polygon(0% 0%, 0% 0%, 100% 100%, 100% 100%, 100% 100%, 0% 0%);\n  }\n\n  100% {\n    clip-path: polygon(0% 0%, 100% 0%, 100% 0%, 100% 100%, 0% 100%, 0% 100%);\n  }\n"]))),re=Object(x.e)(o||(o=Object(f.a)(["\n  0% {\n    clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%, 0% 0%, 100% 100%, 100% 100%, 100% 100%, 0% 0%);\n  }\n\n  100% {\n    clip-path: polygon(100% 0%, 100% 0%, 100% 100%, 0% 100%, 0% 100%, 0% 100%, 100% 100%, 100% 0%, 100% 0%);\n  }\n"]))),ce=Object(x.e)(i||(i=Object(f.a)(["\n  0% {\n    fill: #115d5d;\n  }\n\n  20% {\n    fill: #115d5d;\n  }\n\n  100% {\n    fill: #fff;\n  }\n"]))),oe=Object(x.e)(a||(a=Object(f.a)(["\n  0% {\n    fill: #fff;\n  }\n\n  100% {\n    fill: #115d5d;\n  }\n"]))),ie=x.d.button(s||(s=Object(f.a)(["\n    border: none;\n    display: block;\n    height: 3rem;\n    width: 3rem;\n    padding: 1rem .5rem;\n    cursor: pointer;\n    background-color: rgba(0,0,0,0);\n    position: relative;\n    outline: none;\n\n    transition: border-color .2s ease-out;\n    border-left: 3px solid transparent;\n\n    &:focus, &:active {\n        border-left: 3px solid ",";\n    }\n\n    ","\n\n    ","\n"])),(function(e){return e.theme.colors.focus}),(function(e){return e.hoverBackground?"&:hover {\n        background-color: ".concat(e.theme.colors.background.light,";\n    }"):""}),(function(e){return e.large&&"@media all and (min-width: ".concat(e.theme.widths.sm,") {\n        height: 4rem;\n        width: 5rem;\n        padding: 1rem;\n    }")})),ae=x.d.div(l||(l=Object(f.a)(["\n    position: absolute;\n    top: 0;\n    left: 0;\n    height: 3rem;\n    width: 2rem;\n    padding: 1rem .5rem;\n    animation: "," .3s ease-out forwards;\n    margin-left: .5rem;\n\n    path {\n        fill: #fff;\n        animation: "," .3s ease-out forwards;\n    }\n\n    opacity: .9;\n    &:hover {\n        opacity: 1;\n    }\n\n    ","\n"])),(function(e){return e.show?te:re}),(function(e){return e.show?ce:oe}),(function(e){return e.large&&"@media all and (min-width: ".concat(e.theme.widths.sm,") {\n        height: 4rem;\n        width: 4rem;\n        padding: 1rem;\n    }")})),se=d.a.memo((function(e){var n=e.state,t=e.paths,r=e.onClick,c=e.loaded,o=void 0===c||c,i=e.hoverBackground,a=void 0!==i&&i,s=e.large,l=void 0!==s&&s;return Object(y.jsx)(ie,{onClick:function(){return r&&r(n)},hoverBackground:a,large:l,children:Object.keys(t).map((function(e){return Object(y.jsx)(ae,{show:o&&n===e,large:l,children:Object(y.jsx)("svg",{viewBox:"0 0 12 12",children:t[e].map((function(e,n){return Object(y.jsx)("path",{d:e},n)}))})},e)}))})})),le=t(22),ue=x.d.span(E||(E=Object(f.a)(["\n    ","\n    ","\n    ","\n    ","\n"])),le.j,le.k,le.i,le.c),de=function(e){var n=e.value,t=e.onChange,r=e.charElements,c=e.freeze,o=""===n?Object(y.jsxs)(ue,{color:"text.placeholder",style:{fontStyle:"italic"},children:["Type your tune here",Object(y.jsx)("br",{}),Object(y.jsx)("br",{})]}):Object(y.jsxs)(y.Fragment,{children:[r,Object(y.jsx)("br",{}),Object(y.jsx)("br",{})]});return Object(y.jsx)(he,{fontSize:["1.1rem","1.4rem"],disabled:c,children:Object(y.jsxs)(be,{children:[Object(y.jsx)(je,{value:n,onChange:t,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:"false",disabled:c}),Object(y.jsx)(fe,{"aria-hidden":"true",freeze:c,children:o})]})})},he=x.d.div(C||(C=Object(f.a)(["\n    height: 100%;\n    overflow: auto;\n    ","\n    ",'\n    line-height: 1.4em;\n    position: relative;\n\n    &:before {\n        content: "";\n        display: block;\n        width: 3px;\n        height: 4rem;\n        background-color: transparent;\n        transition: background-color .2s ease-out;\n        position: absolute;\n        top: 12px;\n    }\n\n    &:focus-within {\n        &:before {\n            background-color: ',";\n        }\n    }\n\n    ","\n"])),le.j,le.k,(function(e){return e.theme.colors.focus}),(function(e){return e.disabled?"\n        cursor: default;\n        user-select: none;\n        pointer-events: none;\n    ":""})),be=x.d.div(T||(T=Object(f.a)(["\n    position: relative;\n    text-align: left;\n    box-sizing: border-box;\n    padding: 0px;\n    overflow: hidden;\n    font-variant-ligatures: common-ligatures;\n    min-height: 100%;\n"]))),je=x.d.textarea(M||(M=Object(f.a)(["\n    margin: 0;\n    border: 0;\n    background: none;\n    box-sizing: inherit;\n    display: inherit;\n    font-family: inherit;\n    font-size: inherit;\n    font-style: inherit;\n    font-variant-ligatures: inherit;\n    font-weight: inherit;\n    letter-spacing: inherit;\n    line-height: inherit;\n    tab-size: inherit;\n    text-indent: inherit;\n    text-rendering: inherit;\n    text-transform: inherit;\n    white-space: pre-wrap;\n    word-break: keep-all;\n    overflow-wrap: break-word;\n    position: absolute;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 100%;\n    resize: none;\n    color: inherit;\n    overflow: hidden;\n    -webkit-text-fill-color: transparent;\n    -webkit-font-smoothing: antialiased;\n    padding: 1rem 1rem 1rem 2rem;\n    outline: 0;\n\n    &::selection {\n        background: #22cece;\n    }\n\n    &:disabled {\n        user-select: none;\n        opacity: 0;\n    }\n"]))),fe=x.d.pre(z||(z=Object(f.a)(["\n    margin: 0px;\n    border: 0px;\n    background: none;\n    box-sizing: inherit;\n    display: inherit;\n    font-family: inherit;\n    font-size: inherit;\n    font-style: inherit;\n    font-variant-ligatures: inherit;\n    font-weight: inherit;\n    letter-spacing: inherit;\n    line-height: inherit;\n    tab-size: inherit;\n    text-indent: inherit;\n    text-rendering: inherit;\n    text-transform: inherit;\n    white-space: pre-wrap;\n    word-break: keep-all;\n    overflow-wrap: break-word;\n    position: relative;\n    pointer-events: ",";\n    padding: 1rem 1rem 1rem 2rem;\n    user-select: none;\n"])),(function(e){return e.freeze?"auto":"none"})),pe=Object(x.e)(P||(P=Object(f.a)(["\n  0% {\n    opacity: 0;\n    top: 1rem;\n  }\n\n  85% {\n    opacity: 0;\n    top: 1rem;\n  }\n\n  100% {\n    opacity: 1;\n    top: 0rem;\n  }\n"]))),me=x.d.div(R||(R=Object(f.a)(["\n    position: relative;\n    top: 0;\n    padding-left: 1rem;\n    animation: "," .7s ease-out forwards;\n"])),pe),ve=Object(x.e)(_||(_=Object(f.a)(["\n  from {\n    opacity: 0;\n  }\n\n  to {\n    opacity: 1;\n  }\n"]))),Oe=x.d.div(L||(L=Object(f.a)(["\n    height: ",";\n    opacity: 0;\n    ","\n"])),(function(e){return e.height}),(function(e){return e.loaded?Object(x.c)(N||(N=Object(f.a)(["animation: "," .1s ease-out forwards;"])),ve):""})),ge=d.a.memo((function(e){var n=e.ch,t=e.charData,r=e.soundEngine,c=Object(u.useState)(!1),o=Object(g.a)(c,2),i=o[0],a=o[1];return function(e,n){var t=Object(u.useRef)(0),r=Object(u.useRef)(performance.now()),c=Object(u.useRef)(performance.now()),o=function n(){var o=performance.now(),i=(o-c.current)/1e3,a=(o-r.current)/1e3;e(i,a),r.current=o,t.current=requestAnimationFrame(n)};Object(u.useEffect)((function(){return t.current=requestAnimationFrame(o),function(){return cancelAnimationFrame(t.current)}}),n)}((function(){var e,n=r.playing()?r.position():-1,c=null!==(e=null===t||void 0===t?void 0:t.playTime)&&void 0!==e?e:[],o=Object(g.a)(c,2),i=o[0],s=o[1];a(-1!==n&&void 0!==i&&void 0!==s&&i<=n&&s>n)}),[n,t]),Object(y.jsx)(xe,{className:i?"active":"",color:null===t||void 0===t?void 0:t.color,children:n})})),xe=x.d.span(D||(D=Object(f.a)(["\n    color: ",";\n    transition: color 0.2s "," ease-out;\n\n    &.active {\n        transition: color 0s 0s linear;\n        color: #fff;\n    }\n"])),(function(e){return e.theme.colors.highlights[e.color||"unknown"]}),(function(e){return"error"===e.color?"0.5s":"0s"})),ye=Object(le.d)(le.i,le.c,le.g,le.e,le.f,le.a,le.b,le.h),we=x.d.div(A||(A=Object(f.a)(["\n    ","\n"])),ye),ke=x.d.div(G||(G=Object(f.a)(["\n    display: flex;\n    ","\n"])),ye),Se=t.p+"static/media/xenpaper-logo-512x512.19f23cff.png",Ee=t(37),Ce=x.d.a(q||(q=Object(f.a)(["\n    color: ",";\n    text-decoration: none;\n    font-style: normal;\n\n    &:hover, &:focus {\n        color: #fff;\n        text-decoration: underline;\n    }\n\n    &:active {\n        color: #fff;\n    }\n"])),(function(e){return e.theme.colors.highlights.unknown})),Te=Object(x.d)((function(e){return Object(y.jsx)(we,Object(p.a)(Object(p.a)({px:3,py:2},e),{},{children:Object(y.jsxs)(ue,{as:"div",color:"text.placeholder",children:[Object(y.jsx)(Ce,{href:"#",children:"Xenpaper"})," ",Object(y.jsx)(Ce,{target:"_blank",href:"https://github.com/dxinteractive/xenpaper/releases",children:"(v1.5.0)"})," is made by ",Object(y.jsx)(Ce,{target:"_blank",href:"https://damienclarke.me",children:"Damien Clarke"})," using ",Object(y.jsx)(Ce,{target:"_blank",href:"https://www.typescriptlang.org/",children:"typescript"}),", ",Object(y.jsx)(Ce,{target:"_blank",href:"https://reactjs.org/",children:"react"}),", ",Object(y.jsx)(Ce,{target:"_blank",href:"https://tonejs.github.io/",children:"tonejs"}),", ",Object(y.jsx)(Ce,{target:"_blank",href:"https://github.com/dmaevsky/rd-parse",children:"rd-parse"}),", ",Object(y.jsx)(Ce,{target:"_blank",href:"https://styled-components.com/",children:"styled-components"})," and ",Object(y.jsx)(Ce,{target:"_blank",href:"https://dendriform.xyz",children:"dendriform"}),"."]})}))}))(H||(H=Object(f.a)(["\n    font-size: .9rem;\n    font-family: ",";\n"])),(function(e){return e.theme.fonts.copy})),Me=function(e){var n=e.onSetTune,t=e.setSidebar;return Object(y.jsxs)(_e,{setSidebar:t,pad:!0,children:[Object(y.jsx)(Ge,{children:"How it works"}),Object(y.jsxs)(Ae,{children:["Create tunes by typing in the text area. Press play to hear what you","'","ve written."]}),Object(y.jsx)(we,{pt:4,children:Object(y.jsx)(Ge,{children:"Notes"})}),Object(y.jsxs)(Ae,{children:["Typing a number will create a note. Notes can be separated by spaces or commas.",Object(y.jsx)(Fe,{tune:"0 4 7 12",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Notes can be held for longer with hyphens ",Object(y.jsx)(He,{children:"---"}),", and rests can be added with dots ",Object(y.jsx)(He,{children:"..."}),".",Object(y.jsx)(Fe,{tune:"0.2.3...3-2-0--.",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Spaces, new lines and bars ",Object(y.jsx)(He,{children:"|"})," can be placed anywhere between notes. Bars can also be placed during a note.",Object(y.jsx)(Fe,{tune:"0 8 7-|0 8 7-|-5 4--",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Notes can be written in many ways.",Object(y.jsx)("br",{}),"- as scale degrees starting from zero ",Object(y.jsx)(He,{children:"0,2,4"}),",",Object(y.jsx)("br",{}),"- as ratios ",Object(y.jsx)(He,{children:"3/2,5/4,1/1"}),",",Object(y.jsx)("br",{}),"- as cents ",Object(y.jsx)(He,{children:"702c"}),",",Object(y.jsx)("br",{}),"- as divisions of an octave ",Object(y.jsxs)(He,{children:["11","\\","19"]}),",",Object(y.jsx)("br",{}),"- as divisions of an octave with a specific size (e.g. 3) ",Object(y.jsxs)(He,{children:["5","\\","13o3"]}),Object(y.jsx)("br",{}),"- as cycles per second ",Object(y.jsx)(He,{children:"432Hz"}),Object(y.jsx)(Fe,{tune:"0 7 1/1 3/2 0c 702c\n0\\19 11\\19 440Hz 660Hz",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Notes can be shifted up or down octaves. ",Object(y.jsx)(He,{children:"'"})," shifts the following note up 1 octave, ",Object(y.jsx)(He,{children:'"'})," shifts the following note up 2 octaves, and ",Object(y.jsx)(He,{children:"`"})," shifts the following note down an octave.",Object(y.jsx)(Fe,{tune:"0-3-'0-'3-\"0-'\"0-`0-``0-",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Chords can be played by using ",Object(y.jsx)(He,{children:"["})," and ",Object(y.jsx)(He,{children:"]"})," around a comma-separated pitches.",Object(y.jsx)(Fe,{tune:"[3,7]-[5,8]-[0,3,7]--.[1/1,6/5,3/2]--.",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Chords can also be played using colon-notated ratios ",Object(y.jsx)(He,{children:"4:5:6"}),Object(y.jsx)(Fe,{tune:"10:12:15---",color:"pitch",onSetTune:n})]}),Object(y.jsx)(we,{pt:4,children:Object(y.jsx)(Ge,{children:"Comments"})}),Object(y.jsxs)(Ae,{children:["Comments can be added using ",Object(y.jsx)(He,{children:"#"})," at the start of a line",Object(y.jsx)(Fe,{tune:"# a 7th chord\n[0,4,7,10]--..\n\n# a harmonic 7th chord\n4:5:6:7--..",color:"pitch",onSetTune:n})]}),Object(y.jsx)(we,{pt:4,children:Object(y.jsx)(Ge,{children:"Scales"})}),Object(y.jsxs)(Ae,{children:["The scale can be changed at any time. A scale is denoted by ",Object(y.jsx)(He,{children:"{"})," and ",Object(y.jsx)(He,{children:"}"}),". These dictate what pitches any subsequent scale degrees correspond to. The default is 12 equal divisons of the octave ",Object(y.jsx)(He,{children:"12edo"}),".",Object(y.jsx)(Fe,{tune:"[0,4,7]--- {31edo}[0,10,18]---",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Equal division octave size can be changed by replacing the ",'"o"'," with a number or fraction ",Object(y.jsx)(He,{children:"13ed3"}),".",Object(y.jsx)(Fe,{tune:"{13ed3}0 1 2 3 4",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Scales can be comprised of individual pitches.",Object(y.jsx)(Fe,{tune:"{1/1 9/8 5/4 4/3 3/2 5/3 15/8}\n0 1 2 3 4 5 6 7-",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Scales comprised of individual pitches can also set their octave size using ",Object(y.jsx)(He,{children:"'"})," after the last pitch. Defaults to ",Object(y.jsx)(He,{children:"2/1"}),Object(y.jsx)(Fe,{tune:"{1/1 5/4 4/3 3/2'}\n0 1 2 3 4 5 6 7 8-",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Scales can use colon-notated ratios",Object(y.jsx)(Fe,{tune:"{12:14:16:18:21}\n0 1 2 3 4 5 6 7-",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Scales can also reference the scale degrees at the moment they are encountered. This can be useful for creating a subset of a scale.",Object(y.jsx)(Fe,{tune:"{19edo}{0 3 6 8 11 14 17}\n0 1 2 3 4 5 6 7-",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Modes can be set using ",Object(y.jsx)(He,{children:"{m"})," and ",Object(y.jsx)(He,{children:"}"}),".",Object(y.jsx)(Fe,{tune:"{12edo}{m2 1 2 2 1 2 2}\n0 1 2 3 4 5 6 7-",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["All pitch values other than cycles-per-second are relative to a root note. This can be changed with ",Object(y.jsx)(He,{children:"{r...}"}),". It can be given any pitch value to use as the new root. It defaults to ",Object(y.jsx)(He,{children:"{r440Hz}"}),Object(y.jsx)(Fe,{tune:"0 2 4-{r432Hz}0 2 4-",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["As each change to the root pitch is relative to the current root, multiple roots can be chained after each other",Object(y.jsx)(Fe,{tune:"4 0-{r2}4 0-{r2}4 0-",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["This can also be used to switch octaves for a time.",Object(y.jsx)(Fe,{tune:"4 0-{r'0}4 0-{r`0}4 0-",color:"pitch",onSetTune:n})]}),Object(y.jsx)(we,{pt:4,children:Object(y.jsx)(Ge,{children:"Setters"})}),Object(y.jsxs)(Ae,{children:["Setters are a type of statement that are used to set various parameters as a tune progresses, such as ",Object(y.jsx)(He,{children:"(bpm:100)"})," or ",Object(y.jsx)(He,{children:"(osc:sine)"}),". A setter is denoted by ",Object(y.jsx)(He,{children:"("})," and ",Object(y.jsx)(He,{children:")"}),", and can be placed anywhere between notes or on new lines. Multiple setters can be combined into a single statement using a semicolon ",Object(y.jsx)(He,{children:"(bpm:100; osc:sine)"})]}),Object(y.jsx)(we,{pt:4,children:Object(y.jsx)(Ge,{children:"Timing"})}),Object(y.jsxs)(Ae,{children:["Tempo can be changed using the tempo setter ",Object(y.jsx)(He,{children:"(bpm:...)"}),". Defaults to ",Object(y.jsx)(He,{children:"(bpm:120)"}),Object(y.jsx)(Fe,{tune:"(bpm:200)7 5 4 2 0...",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Tempo can also be set using milliseconds per beat ",Object(y.jsx)(He,{children:"(bms:...)"}),".",Object(y.jsx)(Fe,{tune:"(bms:1000)3 2 0",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Divisions of the beat can be set using the division setter ",Object(y.jsx)(He,{children:"(div:...)"}),". These can also be shortened to ",Object(y.jsx)(He,{children:"(...)"}),", like ",Object(y.jsx)(He,{children:"(4)"})," or ",Object(y.jsx)(He,{children:"(1/4)"}),". Defaults to 2 divisions per beat (eighth notes) ",Object(y.jsx)(He,{children:"(div:2)"}),Object(y.jsx)(Fe,{tune:"0 2 3 7(3)0 2 3 7(4)0 2 3 7(1/2)0 2 3 7",color:"pitch",onSetTune:n})]}),Object(y.jsx)(we,{pt:4,children:Object(y.jsx)(Ge,{children:"Sound"})}),Object(y.jsxs)(Ae,{children:["The oscillator can be changed using the oscillator setter ",Object(y.jsx)(He,{children:"(osc:...)"}),". Defaults to ",Object(y.jsx)(He,{children:"(osc:triangle)"}),Object(y.jsx)(Fe,{tune:"(osc:sine)0 4 7.\n(osc:sawtooth)0 4 7.\n(osc:square)0 4 7.",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["Valid values are ",Object(y.jsx)(He,{children:"sine"}),", ",Object(y.jsx)(He,{children:"sawtooth"}),", ",Object(y.jsx)(He,{children:"square"})," and ",Object(y.jsx)(He,{children:"triangle"}),". Any of these can be optionally prefixed with ",Object(y.jsx)(He,{children:"fm"}),", ",Object(y.jsx)(He,{children:"am"}),"or ",Object(y.jsx)(He,{children:"fat"}),". Any of these can be suffixed with an integer from ",Object(y.jsx)(He,{children:"1"})," to ",Object(y.jsx)(He,{children:"32"})," to indicate the number of partials to use.",Object(y.jsx)(Fe,{tune:"(osc:fmsine)0 4 7.\n(osc:fatsquare)0 4 7.\n(osc:sawtooth5)0 4 7.",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["The envelope can be changed using the envelope setter ",Object(y.jsx)(He,{children:"(env:...)"}),". This accepts 4 digits corresponding to attack, decay, sustain and release, where ",Object(y.jsx)(He,{children:"0"})," is fast / small, and ",Object(y.jsx)(He,{children:"9"})," is slow / big. Defaults to ",Object(y.jsx)(He,{children:"(env:2856)"}),Object(y.jsx)(Fe,{tune:"(env:0158)0-.....\n(env:6860)0---...",color:"pitch",onSetTune:n})]}),Object(y.jsxs)(Ae,{children:["All oscillator and envelope options are made possible by ",Object(y.jsx)(Ce,{target:"_blank",href:"https://tonejs.github.io/",children:"tonejs"}),"."]}),Object(y.jsx)(we,{pt:4,children:Object(y.jsx)(Ge,{children:"Bugs and future features"})}),Object(y.jsxs)(Ae,{children:["Find anything broken, or have some ideas you want to share? Visit the ",Object(y.jsx)(Ce,{target:"_blank",href:"https://github.com/dxinteractive/xenpaper/issues",children:"issue tracker on github"})," to file bugs or discuss future features."]}),Object(y.jsx)(we,{display:["block","block","none"],pt:4,children:Object(y.jsx)(Te,{})})]})},ze=function(e){var n=e.setSidebar,t=e.url,r=e.urlEmbed,c='<iframe width="560" height="315" src="'.concat(r,'" title="Xenpaper" frameborder="0"></iframe>'),o=Object(u.useState)(!1),i=Object(g.a)(o,2),a=i[0],s=i[1],l=Object(u.useState)(!1),d=Object(g.a)(l,2),h=d[0],b=d[1];return Object(y.jsxs)(_e,{setSidebar:n,pad:!0,children:[Object(y.jsxs)(we,{children:[Object(y.jsx)(Ge,{children:"Share link"}),Object(y.jsxs)(ke,{children:[Object(y.jsx)(Re,{value:t}),Object(y.jsx)(we,{flexShrink:"0",ml:3,children:Object(y.jsx)(Ee.CopyToClipboard,{text:t,onCopy:function(){return s(!0)},children:Object(y.jsx)(Be,{children:a?"Copied":"Copy"})})})]})]}),Object(y.jsxs)(we,{pt:4,children:[Object(y.jsx)(Ge,{children:"Embed"}),Object(y.jsxs)(ke,{children:[Object(y.jsx)(Re,{value:c}),Object(y.jsx)(we,{flexShrink:"0",ml:3,children:Object(y.jsx)(Ee.CopyToClipboard,{text:t,onCopy:function(){return b(!0)},children:Object(y.jsx)(Be,{children:h?"Copied":"Copy"})})})]}),Object(y.jsx)(we,{pt:3,children:Object(y.jsx)(Pe,{src:r,frameBorder:"0"},r)})]})]})},Pe=x.d.iframe(F||(F=Object(f.a)(["\n    width: 100%;\n"]))),Re=x.d.input.attrs((function(){return{readOnly:!0}}))(B||(B=Object(f.a)(["\n    width: 100%;\n    background-color: ",";\n    font-family: ",";\n    color: #ffffff;\n    padding: .25rem;\n    border: "," 1px solid;\n"])),(function(e){return e.theme.colors.background.normal}),(function(e){return e.theme.fonts.mono}),(function(e){return e.theme.colors.highlights[e.color||"unknown"]})),_e=function(e){var n=e.setSidebar,t=e.children,r=e.title,c=e.pad;return Object(y.jsxs)(Le,{width:["100rem","20rem","30rem","40%"],flexDirection:"column",flexShrink:"0",minHeight:"0",children:[Object(y.jsx)(we,{position:["absolute","fixed"],top:0,right:0,pt:3,pr:3,children:Object(y.jsx)(se,{state:"cross",paths:{cross:["M 1 0 L 12 11 L 11 12 L 0 1 Z","M 1 12 L 12 1 L 11 0 L 0 11 Z"],none:[]},onClick:function(){return n("none")},loaded:!0})}),Object(y.jsxs)(Ne,{children:[r&&Object(y.jsx)(qe,{children:r}),!r&&Object(y.jsxs)(ke,{alignItems:"center",children:[Object(y.jsx)(we,{mr:4,width:"5rem",pt:2,children:Object(y.jsx)("img",{alt:"Xenpaper logo",src:Se,width:"100%"})}),Object(y.jsxs)(we,{children:[Object(y.jsx)(De,{children:"xenpaper"}),Object(y.jsx)(ue,{as:"div",color:"text.placeholder",style:{fontStyle:"italic",lineHeight:"1.3rem"},children:"Text-based microtonal sequencer."}),Object(y.jsx)(ue,{as:"div",color:"text.placeholder",style:{fontStyle:"italic",lineHeight:"1.3rem"},children:"Write down musical ideas and share the link around."})]})]})]}),Object(y.jsx)(we,{p:c?4:0,flexGrow:"1",children:t})]})},Le=Object(x.d)(ke)(I||(I=Object(f.a)(["\n    background-color: ",";\n    font-family: ",";\n    position: relative;\n    animation: .3s ease-out onShow;\n    position: relative;\n    overflow: auto;\n\n    opacity: 1;\n    top: 0;\n\n    @keyframes onShow {\n        0% {\n            opacity: 0;\n            top: .25rem;\n        }\n        100% {\n            opacity: 1;\n            top: 0;\n        }\n    }\n"])),(function(e){return e.theme.colors.background.light}),(function(e){return e.theme.fonts.copy})),Ne=Object(x.d)(we)(V||(V=Object(f.a)(["\n    background-color: ",";\n    padding: 2rem 2rem 1.5rem;\n"])),(function(e){return e.theme.colors.background.normal})),De=Object(x.d)(we)(U||(U=Object(f.a)(["\n    font-size: 2.5rem;\n    line-height: 2rem;\n    margin-bottom: .5rem;\n"]))),Ae=x.d.div(X||(X=Object(f.a)(["\n    margin-bottom: 2rem;\n"]))),Ge=x.d.h2(Z||(Z=Object(f.a)(["\n    font-size: 1.5rem;\n    margin-bottom: 1rem;\n"]))),qe=x.d.h2(W||(W=Object(f.a)(["\n    font-size: 1.5rem;\n"]))),He=x.d.span(Y||(Y=Object(f.a)(["\n    font-family: ",";\n    background-color: ",";\n    padding: .1rem;\n"])),(function(e){return e.theme.fonts.mono}),(function(e){return e.theme.colors.background.normal})),Fe=Object(x.d)((function(e){return Object(y.jsxs)(ke,{className:e.className,children:[Object(y.jsx)(Ie,{children:"e.g. "}),Object(y.jsx)(Ve,{fontSize:["1.1rem","1.4rem"],color:e.color,children:e.tune}),Object(y.jsx)(we,{flexShrink:"0",children:Object(y.jsx)(Be,{onClick:function(){return e.onSetTune(e.tune)},children:"Demo"})})]})}))(K||(K=Object(f.a)(["\n    font-family: ",";\n    padding: .5rem;\n    margin-top: 1rem;\n    background-color: ",";\n    line-height: 2em;\n"])),(function(e){return e.theme.fonts.mono}),(function(e){return e.theme.colors.background.normal})),Be=x.d.button(J||(J=Object(f.a)(["\n    border: none;\n    display: block;\n    padding: .5rem;\n    cursor: pointer;\n    background-color: ",";\n    color: ",";\n    position: relative;\n    outline: none;\n    opacity: 0.7;\n\n    transition: opacity .2s ease-out;\n\n    &:hover, &:focus, &:active {\n        opacity: 1;\n    }\n"])),(function(e){return e.theme.colors.highlights.scale}),(function(e){return e.theme.colors.background.normal})),Ie=x.d.div(Q||(Q=Object(f.a)(["\n    font-style: italic;\n    color: ",";\n    padding-left: .6rem;\n    padding-right: 1rem;\n    flex-shrink: 0;\n"])),(function(e){return e.theme.colors.text.placeholder})),Ve=x.d.pre($||($=Object(f.a)(["\n    flex-grow: 1;\n    ","\n    ","\n    line-height: 1.4em;\n    font-style: normal;\n    color: ",";\n    word-wrap: break-word;\n    white-space: pre-wrap;\n    flex-shrink: 1;\n    width: 0;\n    padding-right: .5rem;\n"])),le.j,le.k,(function(e){return e.theme.colors.highlights[e.color||"unknown"]})),Ue=t(44),Xe=t(35),Ze=t(27);Object(Xe.useStrictMode)(!0);var We=Xe,Ye=We.Stage,Ke=We.Layer,Je=We.Rect,Qe=We.Group,$e=We.Text,en=function(e){return Math.log2(e/20)},nn=function(e){return 20*Math.pow(2,e)},tn=function(e,n,t,r){return n-(e-.5*r)/r*t};function rn(e){var n=e.rulerState,t=Object(u.useCallback)((function(){n.set((function(e){e.notes.clear()}))}),[]);return Object(y.jsxs)(ke,{flexDirection:"column",style:{height:"100%"},children:[Object(y.jsxs)(ke,{p:2,children:[Object(y.jsx)(we,{mr:3,children:n.render("collect",(function(e){return Object(y.jsxs)(an,{children:[Object(y.jsx)("input",Object(p.a)({type:"checkbox"},Object(Ze.a)(e)))," ","collect"]})}))}),Object(y.jsx)(we,{children:Object(y.jsx)(sn,{onClick:t,children:"clear"})})]}),Object(y.jsx)(cn,Object(p.a)({},e))]})}function cn(e){var n=Object(Ue.a)(),t=Object(g.a)(n,2),r=t[0],c=t[1],o=c.width,i=void 0===o?0:o,a=c.height,s=void 0===a?0:a,l=e.rulerState.useValue(),d=l.viewPan,h=l.viewZoom,b=function(e){return function(e,n,t,r){return.5*r-(e-n)*r/t}(en(e.hz),d,h,s)},j=Object(u.useRef)(null),f=Object(u.useCallback)((function(e){var n=e.evt;n.preventDefault(),j.current={startPan:d,startZoom:h,startDrag:tn(n.clientY,d,h,s)}}),[d,h,s]),p=Object(u.useCallback)((function(n){var t=n.evt;t.preventDefault();var r=j.current;if(r){var c=tn(t.clientY,r.startPan,r.startZoom,s);e.rulerState.set((function(e){e.viewPan=r.startPan-c+r.startDrag}))}}),[s]),m=Object(u.useCallback)((function(e){e.evt.preventDefault(),j.current=null}),[]),v=Object(u.useCallback)((function(n){var t=n.evt;t.preventDefault(),e.rulerState.set((function(e){e.viewZoom*=t.deltaY>0?1.1:t.deltaY<0?1/1.1:1}))}),[]),O=Object(u.useCallback)((function(e){e.evt.preventDefault()}),[]),x=Object(u.useCallback)((function(e){e.evt.preventDefault()}),[]),w=Object(u.useCallback)((function(e){e.evt.preventDefault()}),[]);nn(tn(s,d,h,s)),nn(tn(0,d,h,s));return Object(y.jsx)("div",{ref:r,style:{height:"100%",width:"100%",backgroundColor:"#080b0e"},children:Object(y.jsx)(Ye,{width:i,height:s,onMouseDown:f,onMouseMove:p,onMouseUp:m,onWheel:v,onTouchStart:O,onTouchMove:x,onTouchEnd:w,children:Object(y.jsxs)(Ke,{children:[l.collect&&Object(y.jsx)(on,{notes:l.notes,getY:b,color:"#FF0000",width:i}),Object(y.jsx)(on,{notes:l.notesActive,getY:b,color:"#FFFFFF",width:i})]})})})}function on(e){var n=e.width,t=e.color;return Object(y.jsx)(y.Fragment,{children:Array.from(e.notes.entries()).map((function(r){var c=Object(g.a)(r,2),o=c[0],i=c[1];return Object(y.jsxs)(Qe,{y:e.getY(i),children:[Object(y.jsx)(Je,{width:n,height:1,fill:t}),Object(y.jsx)($e,{text:i.label,fill:t})]},o)}))})}var an=x.d.label(ee||(ee=Object(f.a)(["\n    user-select: none;\n"]))),sn=x.d.button(ne||(ne=Object(f.a)(["\n    border: none;\n    display: block;\n    padding: .25rem .5rem;\n    cursor: pointer;\n    background-color: ",";\n    color: ",";\n    position: relative;\n    outline: none;\n    opacity: 0.7;\n\n    transition: opacity .2s ease-out;\n\n    &:hover, &:focus, &:active {\n        opacity: 1;\n    }\n"])),(function(e){return e.theme.colors.highlights.unknown}),(function(e){return e.theme.colors.background.normal})),ln=t(16),un=t(17);function dn(e,n,t){return Object(un.c)(n,(function(n,r){return Object(p.a)(Object(p.a)({type:e,delimiter:!1},t(n)),{},{pos:r.pos})}))}var hn=function(e){return e.reduce((function(e,n){return e+n.len}),0)},bn=function(e){return{delimiter:!0,len:Object(g.a)(e,1)[0].length}},jn=dn("Semicolon",/(^[;]\s*)/,bn),fn=dn("Colon",/(^[:]\s*)/,bn),pn=dn("BarLine","|",(function(){return{len:1,delimiter:!0}})),mn=dn("Whitespace",/(^[,\s]+)/,(function(e){return{len:Object(g.a)(e,1)[0].length,delimiter:!0}})),vn=dn("OctaveModifier",/^(['"]+|`+)/,(function(e){var n=Object(g.a)(e,1)[0];return{octave:n.split("'").length-1+2*(n.split('"').length-1)-(n.split("`").length-1),len:n.length}})),On=dn("PitchCents",/^(\d+|\d+\.(\d+)?)c/,(function(e){var n=Object(g.a)(e,1)[0];return{cents:Number(n),len:n.length+1}})),gn=dn("PitchOctaveDivision",/^([\d]+)[\\/]([\d]+)o(\d)?(\/(\d))?/,(function(e){var n=Object(g.a)(e,5),t=n[0],r=n[1],c=n[2],o=void 0===c?"":c,i=n[3],a=void 0===i?"":i,s=n[4],l=void 0===s?"":s;return{numerator:Number(t),denominator:Number(r),octaveSize:Number(o||2)/Number(l||1),len:t.length+r.length+o.length+2+a.length}})),xn=dn("PitchOctaveDivision",/^([\d]+)[\\]([\d]+)/,(function(e){var n=Object(g.a)(e,2),t=n[0],r=n[1];return{numerator:Number(t),denominator:Number(r),octaveSize:2,len:t.length+r.length+1}})),yn=dn("PitchRatio",/^([\d]+)\/([\d]+)/,(function(e){var n=Object(g.a)(e,2),t=n[0],r=n[1];return{numerator:Number(t),denominator:Number(r),len:t.length+r.length+1}})),wn=dn("PitchDegree",/^([\d]+)/,(function(e){var n=Object(g.a)(e,1)[0];return{degree:Number(n),len:n.length}})),kn=dn("PitchHz",/^(\d+|\d+\.(\d+)?)hz/i,(function(e){var n=Object(g.a)(e,1)[0];return{hz:Number(n),len:n.length+2}})),Sn=dn("Pitch",Object(un.a)(Object(un.d)(vn),Object(un.b)(On,kn,gn,xn,yn,wn)),(function(e){if(1===e.length){var n=Object(g.a)(e,1)[0];return{value:n,len:n.len}}var t=Object(g.a)(e,2),r=t[0],c=t[1];return{value:c,octave:r,len:r.len+c.len}})),En=Object(un.c)(Object(un.a)(Sn,Object(un.e)(Object(un.a)(mn,Sn))),(function(e){return e})),Cn=dn("Hold",/^(([|]?-)+)/,(function(e){var n=Object(g.a)(e,1)[0];return{length:n.replace(/[|]+/g,"").length,len:n.length}})),Tn=Object(un.b)(Cn),Mn=dn("Rest",Object(un.a)(/^(\.)/),(function(e){var n=Object(g.a)(e,1)[0];return{length:n.length,len:n.length}})),zn=dn("Note",Object(un.a)(Sn,Object(un.d)(Tn)),(function(e){var n=Object(g.a)(e,2),t=n[0],r=n[1];return{pitch:t,tail:r,len:t.len+(r?r.len:0)}})),Pn=dn("RatioChordPitch",/^([\d]+)/,(function(e){var n=Object(g.a)(e,1)[0];return{pitch:Number(n),len:n.length}})),Rn=Object(un.c)(Object(un.a)(Pn,fn,Pn,Object(un.e)(Object(un.a)(fn,Pn))),(function(e){return e})),_n=dn("Chord",Object(un.a)("[",Object(un.b)(Rn,En),"]",Object(un.d)(Tn)),(function(e){var n=Object(g.a)(e,2),t=n[0],r=n[1];return{pitches:t,tail:r,len:hn(t)+(r?r.len:0)+2}})),Ln=dn("RatioChord",Object(un.a)(Rn,Object(un.d)(Tn)),(function(e){var n=Object(g.a)(e,2),t=n[0],r=n[1];return{pitches:t,tail:r,len:hn(t)+(r?r.len:0)}})),Nn=dn("EdoScale",/^(\d+)ed([o\d])(\/(\d))?/i,(function(e){var n=Object(g.a)(e,4),t=n[0],r=n[1],c=n[2],o=void 0===c?"":c,i=n[3],a=void 0===i?"":i;return{divisions:Number(t),octaveSize:"o"===r?2:Number(r)/Number(a||1),len:t.length+r.length+2+o.length}})),Dn=dn("ScaleOctaveMarker","'",(function(){return{len:1}})),An=dn("PitchGroupScalePrefix",/(^[m])(\s*)/,(function(e){var n=Object(g.a)(e,2),t=n[0],r=n[1];return{prefix:t,len:t.length+(r?r.length:0)}})),Gn=dn("PitchGroupScale",Object(un.a)(Object(un.d)(An),En,Object(un.d)(Dn)),(function(e){var n=Array.isArray(e[0])?[void 0].concat(Object(ln.a)(e)):e,t=Object(g.a)(n,3),r=t[0],c=t[1],o=t[2];return{pitchGroupScalePrefix:r,pitches:c,scaleOctaveMarker:o,len:(r?r.len:0)+hn(c)+(o?o.len:0)}})),qn=dn("RatioChordScale",Object(un.a)(Rn,Object(un.d)(Dn)),(function(e){var n=Object(g.a)(e,2),t=n[0],r=n[1];return{pitches:t,scaleOctaveMarker:r,len:hn(t)+(r?r.len:0)}})),Hn=Object(un.b)(Nn,qn,Gn),Fn=dn("SetScale",Object(un.a)("{",Hn,"}"),(function(e){var n=Object(g.a)(e,1)[0];return{scale:n,len:n.len+2}})),Bn=dn("SetRoot",Object(un.a)("{r",Sn,"}"),(function(e){var n=Object(g.a)(e,1)[0];return{pitch:n,len:n.len+3}})),In=dn("SetBpmValue",/^(\d+(\.\d+)?)/,(function(e){var n=Object(g.a)(e,1)[0];return{bpm:Number(n),len:n.length}})),Vn=dn("SetBpm",Object(un.a)(/^(bpm:\s*)/,In),(function(e){var n=Object(g.a)(e,2),t=n[0],r=n[1];return{bpm:r.bpm,len:t.length+r.len}})),Un=dn("SetBmsValue",/^(\d+(\.\d+)?)/,(function(e){var n=Object(g.a)(e,1)[0];return{bms:Number(n),len:n.length}})),Xn=dn("SetBms",Object(un.a)(/^(bms:\s*)/,Un),(function(e){var n=Object(g.a)(e,2),t=n[0],r=n[1];return{bms:r.bms,len:t.length+r.len}})),Zn=dn("SetSubdivisionValue",/^([\d]+)(\/(\d))?/,(function(e){var n=Object(g.a)(e,3),t=n[0],r=n[1],c=void 0===r?"":r,o=n[2],i=void 0===o?"":o;return{subdivision:Number(t),denominator:i?Number(i):void 0,len:t.length+c.length}})),Wn=dn("SetSubdivision",Object(un.a)(/^((div:)?\s*)/,Zn),(function(e){var n=Object(g.a)(e,3),t=n[0],r=n[2];return{subdivision:r.subdivision,denominator:r.denominator,len:t.length+r.len}})),Yn=dn("SetOscValue",/^([a-z0-9]*)/,(function(e){var n=Object(g.a)(e,1)[0];return{osc:n,len:n.length}})),Kn=dn("SetOsc",Object(un.a)(/^(osc:\s*)/,Yn),(function(e){var n=Object(g.a)(e,2),t=n[0],r=n[1];return{osc:r.osc,len:t.length+r.len}})),Jn=dn("SetEnvValue",/^(([0-9])([0-9])([0-9])([0-9]))/,(function(e){var n=Object(g.a)(e,5),t=n[0],r=n[1],c=n[2],o=n[3],i=n[4];return{a:Number(r),d:Number(c),s:Number(o),r:Number(i),len:t.length}})),Qn=dn("SetEnv",Object(un.a)(/^(env:\s*)/,Jn),(function(e){var n=Object(g.a)(e,2),t=n[0],r=n[1];return{a:r.a,d:r.d,s:r.s,r:r.r,len:t.length+r.len}})),$n=dn("SetRulerRange",Object(un.a)(/^(rl:)/,Sn,",",Sn),(function(e){var n=Object(g.a)(e,3),t=n[0],r=n[1],c=n[2];return{low:r,high:c,len:t.length+1+r.len+c.len}})),et=dn("SetRulerGrid",/^(rl:grid)/,(function(e){return{len:Object(g.a)(e,1)[0].length}})),nt=Object(un.b)($n,et),tt=Object(un.b)(Vn,Xn,Wn,Kn,Qn,nt),rt=dn("SetterGroup",Object(un.a)("(",tt,Object(un.e)(Object(un.a)(jn,tt)),")"),(function(e){return{setters:e,len:hn(e)+2}})),ct=dn("Comment",/^#([^\n]*)/,(function(e){var n=Object(g.a)(e,1)[0];return{comment:n,len:n.length+1}})),ot=dn("Sequence",Object(un.e)(Object(un.b)(ct,Ln,zn,_n,Mn,rt,Fn,Bn,pn,mn)),(function(e){return{items:e,len:hn(e)}})),it=dn("ParamEmbed","embed",(function(){return{len:5}})),at=Object(un.b)(it),st=dn("ParamGroup",Object(un.a)(at,Object(un.e)(Object(un.a)(jn,at)),":"),(function(e){return{params:e,len:hn(e)+1}})),lt=dn("XenpaperGrammar",Object(un.a)(Object(un.d)(st),Object(un.d)(ot)),(function(e){var n=e.find((function(e){return"ParamGroup"===e.type})),t=e.find((function(e){return"Sequence"===e.type}));return{sequence:t,paramGroup:n,len:t?t.len:0}})),ut=Object(un.f)(lt),dt=new Map([["Semicolon","delimiter"],["Colon","delimiter"],["Pitch","pitch"],["RatioChordPitch","pitch"],["Chord","chord"],["Chord.Whitespace","pitch"],["Hold","pitch"],["Rest","delimiter"],["BarLine","delimiter"],["Whitespace","delimiter"],["EdoScale","scale"],["PitchGroupScale","scale"],["PitchGroupScale.Pitch","scale"],["PitchGroupScale.Whitespace","scale"],["RatioChordScale","scale"],["RatioChordScale.RatioChordPitch","scale"],["RatioChordScale.Colon","scale"],["ScaleOctaveMarker","scale"],["SetScale","scaleGroup"],["SetRoot","scaleGroup"],["SetRoot.Pitch","scale"],["SetBpm","setter"],["SetBms","setter"],["SetSubdivision","setter"],["SetOsc","setter"],["SetEnv","setter"],["SetRulerGrid","setter"],["SetRulerRange","setter"],["SetRulerRange.Pitch","setter"],["SetterGroup","setterGroup"],["SetterGroup.Semicolon","setterGroup"],["Comment","comment"]]),ht=function e(n,t,r,c){if(Array.isArray(t))t.forEach((function(t){return e(n,t,r,c)}));else if(t instanceof Object){var o=dt.get("".concat(r,".").concat(t.type))||dt.get(t.type),i=null!==c&&void 0!==c?c:t.time;if("number"===typeof t.pos&&"number"===typeof t.len&&o)for(var a=0;a<t.len;a++)n[t.pos+a]={color:"comment"===o&&0===a?"commentStart":o,playTime:i};Object.keys(t).forEach((function(r){e(n,t[r],t.type,i)}))}else;},bt=function(e){var n=e.sequence;if(!n)return[];var t=n.items,r=[];return ht(r,t,""),r},jt=t(0),ft=t(1),pt=function(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Math.pow(t,(e+r*n)/n)},mt=function(e){return e.slice().sort((function(e,n){return e.time<n.time?-1:e.time>n.time?1:0}))},vt=function(e,n,t){var r=e/60,c=n/60;return r===c?t/c*1e3:2*t*(c-r)/(c*c-r*r)*1e3},Ot=function(e){var n=[];n.push({bpm:60,bpmEnd:60,time:0,ms:0});var t=e.filter((function(e){return"TEMPO"===e.type}));return mt(t).forEach((function(e,t,r){var c=n[n.length-1],o=r[t+1],i=vt(c.bpm,c.bpmEnd,e.time-c.time)+c.ms,a=o&&o.lerp?o.bpm:e.bpm;n.push({bpm:e.bpm,bpmEnd:a,time:e.time,ms:i})})),function(e){var t=function(e,n){for(var t=e.length-1;t>=0;t--)if(n>=e[t].time)return e[t];return e[0]}(n,e);return vt(t.bpm,t.bpmEnd,e-t.time)+t.ms}},gt=function(){function e(){Object(jt.a)(this,e),this.scoreMs=void 0,this.events={end:new Set,note:new Set}}return Object(ft.a)(e,[{key:"playing",value:function(){return!1}},{key:"looping",value:function(){return!1}},{key:"position",value:function(){return 0}},{key:"endPosition",value:function(){return 0}},{key:"play",value:function(){var e=Object(O.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){var e=Object(O.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"gotoMs",value:function(){var e=Object(O.a)(v.a.mark((function e(n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"setLoop",value:function(e){}},{key:"setLoopActive",value:function(e){}},{key:"setLoopStart",value:function(){}},{key:"setLoopEnd",value:function(){}},{key:"setScore",value:function(){var e=Object(O.a)(v.a.mark((function e(n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"_triggerEvent",value:function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];this.events[e].forEach((function(e){return e.apply(void 0,t)}))}},{key:"onEnd",value:function(e){var n=this;return this.events.end.add(e),function(){n.events.end.delete(e)}}},{key:"onNote",value:function(e){var n=this;return this.events.note.add(e),function(){n.events.note.delete(e)}}}]),e}(),xt=function(e,n,t,r){if(n<t||n>r)throw new Error("".concat(e," must be between ").concat(t," and ").concat(r,", got ").concat(n))},yt=function(e,n,t){var r;xt("Octave size",t,-20,20);var c=e.value.type,o=Math.pow(t,(null===e||void 0===e||null===(r=e.octave)||void 0===r?void 0:r.octave)||0);if("PitchRatio"===c){var i=e.value,a=i.numerator/i.denominator;return xt("Pitch ratio",a,0,100),a*o}if("PitchCents"===c){var s=e.value.cents;return xt("Cents",s,-12e3,12e3),function(e){return pt(e,1200,2,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}(s)*o}if("PitchOctaveDivision"===c){var l=e.value,u=l.numerator,d=l.denominator,h=l.octaveSize;return pt(u,d,h)*o}if("PitchDegree"===c){var b=e.value.degree;return St(b,n,t)*o}throw new Error('Unknown pitch type "'.concat(c,'"'))},wt=function(e,n){for(var t=[],r=0;r<e;r++)t.push(pt(r,e,n));return t},kt=function(e,n){xt("Scale degree",e,-1e3,1e3);for(var t=n.length,r=0;e>=t&&r>-20;)e-=t,r++;for(;e<0&&r<20;)e+=t,r--;return[e,r]},St=function(e,n,t){if(xt("Octave size",t,-20,20),0===n.length)return 1;var r=kt(e,n),c=Object(g.a)(r,2),o=c[0],i=c[1];return n[o]*Math.pow(t,i)},Et=function(e,n){if("PitchHz"===e.value.type){var t,r=Math.pow(n.octaveSize,(null===e||void 0===e||null===(t=e.octave)||void 0===t?void 0:t.octave)||0),c=e.value.hz*r;return xt("Hz",c,0,2e4),c}return yt(e,n.scale,n.octaveSize)*n.rootHz},Ct=function(e,n){var t=n.time,r=e&&"Hold"===e.type?e.length+1:1;return n.time+=r*n.subdivision,{time:t,timeEnd:n.time}},Tt=function(e,n){var t=e.value.type;if("PitchRatio"===t){var r=e.value,c=r.numerator,o=r.denominator;return xt("Pitch ratio",c/o,0,100),"".concat(c,"/").concat(o)}if("PitchCents"===t){var i=e.value.cents;return"".concat(i,"c")}if("PitchOctaveDivision"===t){var a=e.value,s=a.numerator,l=a.denominator;return"".concat(s,"\\").concat(l)}if("PitchDegree"===t){var u=e.value.degree,d=kt(u,n.scale),h=Object(g.a)(d,1)[0];return n.scaleLabels[h]}if("PitchHz"===t){var b=e.value.hz;return"".concat(b,"Hz")}throw new Error('Unknown pitch type "'.concat(t,'"'))},Mt=function(e){for(var n=[],t=0;t<e;t++)n.push("".concat(t,"\\").concat(e));return n},zt=[0,.003,.006,.01,.033,.1,.33,1,3.3,10],Pt=[],Rt=function(e,n){var t=e.tail,r=e.pitches,c=Ct(t,n),o=[c.time,c.timeEnd];Pt.push(o),e.time=o;var i=r.filter((function(e){return"Pitch"===e.type})).map((function(e){return Object(p.a)({type:"NOTE_TIME",hz:Et(e,n),label:Tt(e,n)},c)})),a=r.find((function(e){return"RatioChordPitch"===e.type})),s=r.filter((function(e){return"RatioChordPitch"===e.type})).map((function(e){var t=e.pitch,r=a.pitch;return Object(p.a)({type:"NOTE_TIME",hz:t/r*n.rootHz,label:"".concat(t,"/").concat(r)},c)}));return i.concat(s)},_t=function(e){var n=e.sequence;if(!n)return{};var t={type:"PARAM_TIME",time:0,value:{type:"env",a:zt[2],d:zt[8],s:.5,r:zt[6]}},r={rootHz:440,time:0,subdivision:.5,scale:wt(12,2),scaleLabels:Mt(12),octaveSize:2},c=[],o={};n.items.forEach((function(e){var n=e.type;if("Comment"!==n&&"BarLine"!==n&&"Whitespace"!==n)if("SetScale"!==n)if("SetRoot"!==n)if("Note"!==n){if("Rest"===n){var t=r.time,i=e;r.time+=i.length*r.subdivision;var a=[t,r.time];return Pt.push(a),void(i.time=a)}if("Chord"!==n)if("RatioChord"!==n){if("SetterGroup"!==n)throw new Error('Unknown sequence item "'.concat(n,'"'));e.setters.forEach((function(e){c.push.apply(c,Object(ln.a)(function(e,n){var t=e.type;if(e.delimiter)return[];if("SetBpm"===t){var r=e.bpm;return[{type:"TEMPO",time:n.time,bpm:r,lerp:!1}]}if("SetBms"===t){var c=e.bms;return[{type:"TEMPO",time:n.time,bpm:6e4/c,lerp:!1}]}if("SetSubdivision"===t){var o=e,i=o.subdivision,a=o.denominator;return n.subdivision=(null!==a&&void 0!==a?a:1)/i,[]}if("SetOsc"===t){var s=e.osc;return[{type:"PARAM_TIME",time:n.time,value:{type:"osc",osc:s}}]}if("SetEnv"===t){var l=e,u=l.a,d=l.d,h=l.s,b=l.r;return[{type:"PARAM_TIME",time:n.time,value:{type:"env",a:zt[u]||0,d:zt[d]||0,s:h/9,r:zt[b]||0}}]}return[]}(e,r))),o=Object(p.a)(Object(p.a)({},o),function(e,n){var t=e.type;if(e.delimiter)return{};if("SetRulerGrid"===t)return{};if("SetRulerRange"===t){var r=e,c=r.low,o=r.high;return{lowHz:Et(c,n),highHz:Et(o,n)}}return{}}(e,r))}))}else c.push.apply(c,Object(ln.a)(Rt(e,r)));else c.push.apply(c,Object(ln.a)(Rt(e,r)))}else c.push.apply(c,Object(ln.a)(function(e,n){var t=Ct(e.tail,n),r=[t.time,t.timeEnd];return Pt.push(r),e.time=r,[Object(p.a)({type:"NOTE_TIME",hz:Et(e.pitch,n),label:Tt(e.pitch,n)},t)]}(e,r)));else{var s=e.pitch;r.rootHz=Et(s,r)}else!function(e,n){var t=e.scale,r=t.type;if("PitchGroupScale"===r){var c=t,o=c.pitches,i=c.scaleOctaveMarker,a=c.pitchGroupScalePrefix,s=o.filter((function(e){return!e.delimiter}));if(a&&"m"===a.prefix){var l=[{type:"PitchDegree",degree:0,delimiter:!1,pos:a.pos,len:0}],u=0;s.forEach((function(e){if("PitchDegree"!==e.value.type)throw new Error("Mode scales {m} should only contain pitch degrees (0, 1, etc), not ratios, hz or any other kind of pitch");u+=e.value.degree,l.push(Object(p.a)(Object(p.a)({},e.value),{},{degree:u}))})),l.pop(),s=l.map((function(e){return{value:e}}))}return n.scale=s.map((function(e){return yt(e,n.scale,n.octaveSize)})),n.scaleLabels=s.map((function(e){return Tt(e,n)})),void(i&&(n.octaveSize=n.scale.pop()||2,n.scaleLabels.pop()))}if("EdoScale"===r){var d=t,h=d.divisions,b=d.octaveSize;return n.scale=wt(h,b),n.scaleLabels=Mt(h),void(n.octaveSize=b)}if("RatioChordScale"===r){var j=t,f=j.pitches,m=j.scaleOctaveMarker,v=f.filter((function(e){return!e.delimiter})).map((function(e){return e.pitch}));return n.scale=v.map((function(e){return e/v[0]})),n.scaleLabels=v.map((function(e){return"".concat(e,"/").concat(v[0])})),void(m&&(n.octaveSize=n.scale.pop()||2,n.scaleLabels.pop()))}throw new Error('Unknown scale type "'.concat(r,'"'))}(e,r)}));var i=[{type:"TEMPO",time:0,bpm:120,lerp:!1},{type:"PARAM_TIME",time:0,value:{type:"osc",osc:"triangle"}},t].concat(c,[{type:"END_TIME",time:r.time}]),a=Ot(i);return Pt.forEach((function(e){e[0]=a(e[0]),e[1]=a(e[1])})),{score:{sequence:i,lengthTime:r.time},initialRulerState:o}},Lt=function(e){return encodeURIComponent(e).replace(/_/g,"%_").replace(/%20/g,"_")},Nt=function(e){return e.split("").reverse().join("")},Dt=function(){var e=Object(u.useState)((function(){var e,n=function(e){return decodeURIComponent(Nt(Nt(e).replace(/_(?!%)/g,Nt("%20"))).replace(/%_/g,"_"))}(window.location.hash.substr(1));!n&&window.localStorage&&(n=null!==(e=window.localStorage.getItem("lasttune"))&&void 0!==e?e:"");return n})),n=Object(g.a)(e,2),t=n[0],r=n[1],c=Object(u.useCallback)((function(){r(window.location.hash)}),[]);Object(u.useEffect)((function(){return window.addEventListener("hashchange",c),function(){window.removeEventListener("hashchange",c)}}),[c]);var o=Object(u.useCallback)((function(e){var n,r=Lt(e);r!==t&&(window.history.replaceState(void 0,void 0,"#"+r),null===(n=window.localStorage)||void 0===n||n.setItem("lasttune",e))}),[t]);return[t,o]},At=new Promise((function(e){window.addEventListener("load",(function n(){window.removeEventListener("load",n),e(null)}))})),Gt=t(24),qt=t(3),Ht=t(2),Ft=t(21);function Bt(e,n){var t=[];return e.forEach((function(e){return t.push.apply(t,Object(ln.a)(n(e)))})),t}for(var It=[],Vt=1;Vt<33;Vt++)It.push("".concat(Vt));var Ut,Xt,Zt,Wt,Yt,Kt=Bt(["sine","sawtooth","square","triangle"],(function(e){return[e,"fm".concat(e),"am".concat(e),"fat".concat(e)]})),Jt=Bt(Kt,(function(e){return[e].concat(Object(ln.a)(It.map((function(n){return"".concat(e).concat(n)}))))})),Qt=function(e){Object(qt.a)(t,e);var n=Object(Ht.a)(t);function t(){var e;Object(jt.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=n.call.apply(n,[this].concat(c)))._started=!1,e._endMs=0,e._loopEndMs=0,e._activeNoteEvents=new Set,e.synth=new Ft.b(Ft.c,{oscillator:{type:"sine",volume:-18},envelope:{attack:.01,sustain:.5,decay:.25,release:.5}}).chain(Ft.a),e}return Object(ft.a)(t,[{key:"playing",value:function(){return"started"===Ft.d.state}},{key:"looping",value:function(){return Ft.d.loop}},{key:"position",value:function(){return 1e3*Ft.d.seconds}},{key:"endPosition",value:function(){return this._endMs}},{key:"start",value:function(){var e=Object(O.a)(v.a.mark((function e(){var n,t=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._started){e.next=7;break}return e.next=3,Ft.e();case 3:this._started=!0,n=function(){t.synth.releaseAll(),t._activeNoteEvents.forEach((function(e){t._triggerEvent("note",e,!1)})),t._activeNoteEvents.clear()},Ft.d.on("stop",n),Ft.d.on("loop",n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"play",value:function(){var e=Object(O.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.start();case 2:Ft.d.start();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){var e=Object(O.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.start();case 2:Ft.d.stop();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"gotoMs",value:function(){var e=Object(O.a)(v.a.mark((function e(n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ft.d.seconds=.001*n;case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"setLoop",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.setLoopActive(e),this.setLoopStart(n),this.setLoopEnd(t)}},{key:"setLoopActive",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Ft.d.loop=e}},{key:"setLoopStart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Ft.d.loopStart=.001*e}},{key:"setLoopEnd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._loopEndMs=e,Ft.d.loopEnd=.001*(0===e?this._endMs:e)}},{key:"setScore",value:function(){var e=Object(O.a)(v.a.mark((function e(n){var t=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scoreMs=n,Ft.d.cancel(),this.scoreMs.sequence.forEach((function(e){if("NOTE_MS"===e.type){var n=e;return Ft.d.schedule((function(e){t.synth.triggerAttackRelease(n.hz,.001*n.msEnd-.001*n.ms,e),t._activeNoteEvents.add(n),t._triggerEvent("note",n,!0)}),.001*n.ms+.1),void Ft.d.schedule((function(e){t._activeNoteEvents.delete(n),t._triggerEvent("note",n,!1)}),.001*n.msEnd+.1)}if("PARAM_MS"!==e.type){if("END_MS"===e.type)return t._endMs=e.ms,0===t._loopEndMs&&t.setLoopEnd(0),void Ft.d.schedule(Object(O.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ft.d.loop){e.next=2;break}return e.abrupt("return");case 2:Ft.d.stop(),t._triggerEvent("end",void 0);case 4:case"end":return e.stop()}}),e)}))),.001*t._endMs);throw new Error("Unexpected item type ".concat(e.type," encountered"))}var r=e;Ft.d.schedule((function(){"osc"===r.value.type&&Jt.includes(r.value.osc)&&t.synth.set({oscillator:{type:r.value.osc,volume:-18}}),"env"===r.value.type&&t.synth.set({envelope:{attack:r.value.a,decay:r.value.d,sustain:r.value.s,release:r.value.r}})}),.001*r.ms)}));case 3:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),t}(gt),$t=t(46);Object(Gt.i)(!1),Object(Gt.c)();var er=new Qt,nr=function(e){try{var n=function(e){try{return ut(e)}catch(n){throw console.error("e",n),new Error(n.message.replace(/Remainder:[\s\S]*/,""))}}(e),t=_t(n),r=t.score,c=t.initialRulerState,o=bt(n);if(r){var i=function(e){var n=Ot(e.sequence);return{sequence:mt(e.sequence).map((function(e){if("NOTE_TIME"===e.type){var t=e;return{type:"NOTE_MS",hz:t.hz,label:t.label,ms:n(t.time),msEnd:n(t.timeEnd)}}if("PARAM_TIME"===e.type){var r=e;return{type:"PARAM_MS",value:r.value,ms:n(r.time)}}if("END_TIME"===e.type)return{type:"END_MS",ms:n(e.time)}})).filter((function(e){return!!e})),lengthMs:n(e.lengthTime)}}(r);er.setScore(i)}return{parsed:n,chars:o,score:r,initialRulerState:c,error:""}}catch(p){for(var a,s,l=p.message.match(/Unexpected token at (\d+):(\d+)/),u=l?Number(l[1])-1:-1,d=l?Number(l[2])-1:-1,h=[],b=0,j=0,f=0;f<e.length+40;f++)b===u&&j===d&&(s=f),"\n"===e[f]?(b++,j=0):j++;return"number"===typeof s&&(a=void 0!==e[s]?p.message.replace("Unexpected token ",'Unexpected token "'.concat(e[s],'" ')):p.message,h[s]={color:"error"}),{parsed:void 0,chars:h,score:void 0,initialRulerState:void 0,error:a}}},tr=function(e,n,t){if(0===t)return 0;for(var r=0,c=0,o=e.split(""),i=0;i<o.length;i++){var a,s=o[i],l=null===n||void 0===n?void 0:n[i],u=null!==(a=null===l||void 0===l?void 0:l.playTime)&&void 0!==a?a:[],d=Object(g.a)(u,2)[1];if(void 0!==d&&(r=d),"\n"===s&&++c===t)return r}return 0},rr={paused:["M 0 0 L 12 6 L 0 12 Z"],playing:["M 0 0 L 4 0 L 4 12 L 0 12 Z","M 8 0 L 12 0 L 12 12 L 8 12 Z"]};function cr(){var e=function(){var e=Object(u.useState)(!1),n=Object(g.a)(e,2),t=n[0],r=n[1];return Object(u.useEffect)((function(){Object(O.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,At;case 2:return e.next=4,document.fonts.ready;case 4:r(!0);case 5:case"end":return e.stop()}}),e)})))()}),[]),t}();return Object(y.jsx)(S,{children:Object(y.jsx)(Oe,{height:"100vh",loaded:e,children:Object(y.jsx)(or,{loaded:e})})})}function or(e){var n=e.loaded,t=Dt(),r=Object(g.a)(t,2),c=r[0],o=r[1],i=Object(Ze.b)((function(){var e=!1,n=c;return n.startsWith("embed:")&&(e=!0,n=n.substr(6)),{tune:n,embed:e,hash:"",url:"",urlEmbed:""}}),{history:300});i.useDerive((function(e){var n=e.tune,t=Lt(n);e.embed&&(n="embed:".concat(n));var r="https://xenpaper.com/#".concat(t),c="https://xenpaper.com/#embed:".concat(t);i.branch("hash").set(n),i.branch("url").set(r),i.branch("urlEmbed").set(c)})),i.branch("hash").useChange((function(e){o(e)}));var a=Object(Ze.b)((function(){return nr(i.value.tune)}));i.useDerive((function(e){a.set(nr(e.tune))}));var s=Object(Ze.b)(!1),l=Object(Ze.b)(0);l.useChange((function(e){er.setLoopStart(tr(i.value.tune,a.value.chars,e))})),Object(u.useEffect)((function(){return er.onEnd((function(){s.set(!1)}))}),[]);var d=Object(Ze.b)(!1),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.lowHz,t=void 0===n?440:n,r=e.highHz,c=void 0===r?880:r;return Object(Ze.b)((function(){var e=en(440),n=1;if(t){var r=en(t),o=en(c);e=.5*(r+o),n=o-r}return{notes:new Map,notesActive:new Map,collect:!0,viewPan:e,viewZoom:n}}))}(a.value.initialRulerState);Object(u.useEffect)((function(){return er.onNote((function(e,n){var t="".concat(e.ms,"-").concat(e.hz);h.set((function(r){n?(r.notesActive.set(t,e),r.notes.set(t,e)):r.notesActive.delete(t)}))}))}),[]);var b=Object(u.useCallback)((function(e){a.value.error||(er.gotoMs(tr(i.value.tune,a.value.chars,l.value)),s.set(e),e?(er.play(),h.set((function(e){e.notes.clear()}))):er.pause())}),[]),j=Object(u.useCallback)((function(e){b("paused"===e)}),[]),f=Object(u.useCallback)((function(){var e=!d.value;d.set(e),er.setLoopActive(e)}),[]);Object(u.useEffect)((function(){var e=function(e){(e.ctrlKey||e.metaKey)&&13===e.keyCode&&b(s.value),(e.ctrlKey||e.metaKey)&&90===e.keyCode&&(e.preventDefault(),e.shiftKey?i.redo():i.undo())};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[]);var p=Object(u.useState)((function(){var e,n;return(null===(e=a.value)||void 0===e||null===(n=e.initialRulerState)||void 0===n?void 0:n.lowHz)?"ruler":"info"})),m=Object(g.a)(p,2),x=m[0],w=m[1],k=Object(u.useCallback)((function(){w((function(e){return"info"!==e?"info":"none"}))}),[]),S=Object(u.useCallback)((function(){w((function(e){return"share"!==e?"share":"none"}))}),[]),E=(Object(u.useCallback)((function(){w((function(e){return"ruler"!==e?"ruler":"none"}))}),[]),Object(u.useCallback)(function(){var e=Object(O.a)(v.a.mark((function e(n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.branch("tune").set(n),e.next=3,er.gotoMs(0);case 3:b(!0);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[])),C={},T=s.render((function(e){return Object(y.jsx)(se,{state:e.useValue()?"playing":"paused",paths:rr,onClick:j,loaded:n,hoverBackground:!0,large:!i.branch("embed").useValue()})}),[n]),M=i.render((function(e){var n=e.useHistory(),t=n.canUndo,r=n.canRedo;return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(hr,{onClick:e.undo,disabled:!t,children:"Undo"}),Object(y.jsx)(hr,{onClick:e.redo,disabled:!r,children:"Redo"})]})})),z=d.render((function(e){return Object(y.jsx)(hr,{onClick:f,active:e.useValue(),children:"Loop"})})),P=Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(hr,{onClick:k,children:"Info"}),Object(y.jsx)(hr,{onClick:S,children:"Share"})]}),R=Object(y.jsxs)(y.Fragment,{children:["info"===x&&Object(y.jsx)(Me,{onSetTune:E,setSidebar:w}),"share"===x&&i.render((function(e){var n=e.branch("url").useValue(),t=e.branch("urlEmbed").useValue();return Object(y.jsx)(ze,{setSidebar:w,url:n,urlEmbed:t})})),"ruler"===x&&Object(y.jsx)(_e,{setSidebar:w,title:"Pitch ruler",children:Object(y.jsx)(rn,{rulerState:h})})]}),_=Object(y.jsx)(sr,{tuneForm:i,parsedForm:a,selectedLine:l}),L=Object(y.jsx)(lr,{tuneForm:i}),N=i.render("url",(function(e){return Object(y.jsx)(br,{href:e.useValue(),target:"_blank",children:"Edit on Xenpaper"})}));return i.branch("embed").useValue()?Object(y.jsx)(ar,{playPause:T,loop:z,code:_,openOnXenpaper:N,htmlTitle:L,codepaneContainerProps:C}):Object(y.jsx)(ir,{playPause:T,undoRedo:M,loop:z,code:_,htmlTitle:L,sidebarToggles:P,sidebar:R,codepaneContainerProps:C})}function ir(e){var n=e.playPause,t=e.undoRedo,r=e.loop,c=e.code,o=e.htmlTitle,i=e.sidebarToggles,a=e.sidebar,s=e.codepaneContainerProps;return Object(y.jsxs)(ke,{height:"100vh",flexDirection:"column",children:[Object(y.jsxs)(ke,{display:["block","flex"],flexGrow:"1",flexShrink:"1",minHeight:"0",position:"relative",children:[Object(y.jsxs)(ur,{display:["flex","none"],position:"fixed",top:0,width:"100%",children:[n,t,r]}),Object(y.jsxs)(ur,{display:["none","block"],mt:4,px:2,pt:"12px",children:[Object(y.jsx)(we,{mb:3,children:n}),t,r,Object(y.jsx)(dr,{my:2}),i]}),Object(y.jsx)(we,Object(p.a)(Object(p.a)({flexGrow:"1",flexShrink:"1",pl:[0,3],overflow:"auto",mt:3,pt:["24px",3]},s),{},{children:c})),Object(y.jsx)(dr,{display:["block","none"],mt:4}),Object(y.jsx)(we,{display:["flex","none"],children:i}),a]}),Object(y.jsx)(Te,{display:["none","none","block"]}),o]})}function ar(e){var n=e.playPause,t=e.loop,r=e.code,c=e.htmlTitle,o=e.openOnXenpaper,i=e.codepaneContainerProps;return Object(y.jsxs)(ke,{height:"100vh",flexDirection:"column",children:[Object(y.jsxs)(ke,{flexGrow:"1",flexShrink:"1",minHeight:"0",position:"relative",children:[Object(y.jsxs)(ur,{display:"flex",position:"fixed",top:0,width:"100%",children:[n,t,o]}),Object(y.jsx)(we,Object(p.a)(Object(p.a)({flexGrow:"1",flexShrink:"1",overflow:"auto",mt:3,pt:"24px"},i),{},{children:r}))]}),c]})}function sr(e){return e.tuneForm.render((function(n){var t=n.branch("embed").useValue(),r=e.parsedForm.useValue(),c=r.chars,o=r.error,i=Object(Ze.c)(n.branch("tune"),200),a=i.value.split(""),s=a.map((function(e,n){return null===c||void 0===c?void 0:c[n]})),l=a.some((function(e){return"\n"===e})),u=0,d=[],h=function(){d.push(Object(y.jsx)(jr,{line:u++,selectedLine:e.selectedLine},"playstart".concat(u)))};l&&h(),s.forEach((function(e,n){var t=a[n];d.push(Object(y.jsx)(ge,{ch:t,charData:e,soundEngine:er},n)),"\n"===t&&h()}));return Object(y.jsxs)(we,{onClick:function(e){return e.stopPropagation()},children:[Object(y.jsx)(de,Object(p.a)(Object(p.a)({},i),{},{charElements:d,freeze:t})),o&&Object(y.jsx)(we,{children:Object(y.jsxs)(me,{children:["Error: ",o]})})]})}))}function lr(e){return e.tuneForm.render("tune",(function(e){var n=e.useValue(),t=0===n.length?"Xenpaper":n.length>20?"Xenpaper: ".concat(n.slice(0,20),"..."):"Xenpaper: ".concat(n);return Object(y.jsxs)($t.a,{children:[Object(y.jsx)("title",{children:t}),Object(y.jsx)("meta",{property:"og:title",content:t})]})}))}var ur=Object(x.d)(we)(Ut||(Ut=Object(f.a)(["\n     background-color: ",";\n     z-index: 4;\n"])),(function(e){return e.theme.colors.background.normal})),dr=Object(x.d)(we)(Xt||(Xt=Object(f.a)(["\n     border-top: 1px "," solid;\n"])),(function(e){return e.theme.colors.background.light})),hr=x.d.button(Zt||(Zt=Object(f.a)(["\n    border: none;\n    display: block;\n    padding: ",";\n    cursor: ",";\n    background-color: ",";\n    color: ",";\n    position: relative;\n    outline: none;\n    font-family: ",";\n    font-size: ",";\n    text-align: center;\n    width: auto;\n    text-transform: uppercase;\n    border-left: 3px solid transparent;\n    ","\n\n    ","\n\n    @media all and (min-width: ",") {\n        padding: .5rem;\n        font-size: ",";\n        width: 5rem;\n    }\n"])),(function(e){return e.multiline?".5rem":"1rem .5rem"}),(function(e){return e.disabled?"default":"pointer"}),(function(e){return e.active?e.theme.colors.text.placeholder:e.theme.colors.background.normal}),(function(e){return e.disabled?e.theme.colors.highlights.unknown:e.active?e.theme.colors.background.normal:e.theme.colors.highlights.comment}),(function(e){return e.theme.fonts.mono}),(function(e){return e.multiline?"0.8rem":"0.9rem"}),(function(e){return e.multiline&&"line-height: 1em;"}),(function(e){return e.active?"":"&:hover, &:focus, &:active {\n        background-color: ".concat(e.theme.colors.background.light,";\n    }")}),(function(e){return e.theme.widths.sm}),(function(e){return e.multiline?"0.9rem":"1.1rem"})),br=x.d.a(Wt||(Wt=Object(f.a)(["\n    border: none;\n    height: 3rem;\n    line-height: 1rem;\n    display: block;\n    padding: ",";\n    cursor: pointer;\n    background-color: ",";\n    color: ",";\n    position: relative;\n    outline: none;\n    font-family: ",";\n    font-size: ",";\n    text-align: center;\n    width: auto;\n    text-transform: uppercase;\n    border-left: 3px solid transparent;\n    ","\n    text-decoration: none;\n\n    &:hover, &:focus, &:active {\n        background-color: ",";\n        text-decoration: none;\n    }\n\n    margin-left: auto;\n\n    @media all and (min-width: ",") {\n        font-size: ",";\n    }\n"])),(function(e){return e.multiline?".5rem":"1rem .5rem"}),(function(e){return e.theme.colors.background.normal}),(function(e){return e.theme.colors.highlights.comment}),(function(e){return e.theme.fonts.mono}),(function(e){return e.multiline?"0.8rem":"0.9rem"}),(function(e){return e.multiline&&"line-height: 1em;"}),(function(e){return e.theme.colors.background.light}),(function(e){return e.theme.widths.sm}),(function(e){return e.multiline?"0.9rem":"1.1rem"})),jr=Object(x.d)((function(e){var n=e.line,t=e.selectedLine,r=Object(j.a)(e,["line","selectedLine"]);return Object(y.jsx)("span",Object(p.a)(Object(p.a)({},r),{},{onClick:function(){return t.set(n)},children:">"}))}))(Yt||(Yt=Object(f.a)(["\n    position: absolute;\n    left: .8rem;\n    border: none;\n    display: block;\n    cursor: pointer;\n    color: ",";\n    outline: none;\n    opacity: ",";\n    pointer-events: auto;\n\n    transition: opacity .2s ease-out;\n\n    &:hover, &:focus, &:active {\n        opacity: 1;\n    }\n"])),(function(e){return e.theme.colors.text.placeholder}),(function(e){return e.selectedLine.useValue()===e.line?"1":".2"})),fr=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,72)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,o=n.getLCP,i=n.getTTFB;t(e),r(e),c(e),o(e),i(e)}))};b.a.render(Object(y.jsx)(d.a.StrictMode,{children:Object(y.jsx)(cr,{})}),document.getElementById("root")),fr()}},[[71,1,2]]]);
//# sourceMappingURL=main.3ae74157.chunk.js.map